module.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(1)),{DB_DRIVER:u="pgsql"}=r.default(process.env),o=n(11);t.default=()=>(new(0,o(`./${u}.ts`).default)).init()},function(e,t){e.exports=require("dotenv-parse-variables")},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,u){function o(e){try{a(i.next(e))}catch(e){u(e)}}function s(e){try{a(i.throw(e))}catch(e){u(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const u=n(3),o=n(4),s=r(n(5)),a=n(6),l=n(9);t.default=e=>i(void 0,void 0,void 0,(function*(){yield i(void 0,void 0,void 0,(function*(){const e=u.resolve("/home/dunloop/www/@jsway/planner/storage","migrations.json"),t=o.existsSync(e)?JSON.parse(o.readFileSync(e).toString()):{},n=yield l.keys().sort((e,t)=>{const[{birthtimeMs:n},{birthtimeMs:i}]=[e,t].map(e=>o.statSync(u.resolve("/home/dunloop/www/@jsway/planner/src/backend/migrations",e)));return n-i}).reduce((e,n)=>e.then(e=>i(void 0,void 0,void 0,(function*(){const i=u.parse(n).name;if(t[i])return e;const r=new(0,l(n).default);return yield r.up(),e[i]={key:i,time:(new Date).toLocaleString("ru")},e}))),Promise.resolve({}));o.writeFileSync(e,JSON.stringify(Object.assign(Object.assign({},t),n),null,2))})),(e=>{e.post("/api/:controller/:action",s.default.json(),(e,t)=>{const n=e.params,{controller:i,action:r}=n,{body:u}=e,o=(0,(new(0,a(`./${i}.ts`).default))[r])(u);t.send(o)})})(e)}))},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("express")},function(e,t,n){var i={"./notes.categories.ts":7,"./notes.ts":8};function r(e){var t=u(e);return n(t)}function u(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=u,e.exports=r,r.id=6},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{list(){return[{notes_categories:"list"}]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=[{id:1,title:"Заметка 123",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed urna vel nulla varius congue. Nunc tempor efficitur egestas. Fusce sapien purus, porta pellentesque luctus non, facilisis nec ante. Nunc laoreet magna vel tempor elementum. Duis finibus lectus at mauris malesuada, nec blandit neque aliquam. Quisque urna dui, eleifend eget nisi vel, aliquam rhoncus odio. Integer tempor, dui eu molestie aliquam, eros nulla pharetra leo, quis consectetur orci orci id mi. Donec id nulla mi."},{id:2,title:"Еще одна заметка",description:"Quisque pellentesque massa at ante bibendum semper. Nunc egestas orci vel nulla auctor porta. Ut ultrices, mauris sed hendrerit feugiat, arcu metus tristique leo, non auctor ex nisi sit amet purus. Suspendisse rutrum vehicula nisi eu aliquam. In ullamcorper nisl sit amet urna aliquet faucibus. Nulla id cursus tortor, nec blandit sapien. Etiam posuere turpis ac elit fringilla rutrum. Fusce ullamcorper tellus et neque vehicula auctor. Vivamus et magna et orci eleifend fermentum ut quis lacus. Pellentesque cursus dui sed mi commodo, ac hendrerit nisl laoreet. Nullam gravida faucibus vulputate. Sed vehicula nisl vel orci bibendum tincidunt. Phasellus velit ex, vehicula id neque at, feugiat tincidunt quam. Sed vitae enim ut justo tempus sollicitudin sed eget sapien. Vivamus laoreet elit varius ipsum facilisis malesuada quis ut nunc."},{id:3,title:"Третья заметка",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed urna vel nulla varius congue. Nunc tempor efficitur egestas. Fusce sapien purus, porta pellentesque luctus non, facilisis nec ante. Nunc laoreet magna vel tempor elementum. Duis finibus lectus at mauris malesuada, nec blandit neque aliquam. Quisque urna dui, eleifend eget nisi vel, aliquam rhoncus odio. Integer tempor, dui eu molestie aliquam, eros nulla pharetra leo, quis consectetur orci orci id mi. Donec id nulla mi."}];t.default=class{list(){return i}get(e){let{id:t}=e;return i.find(e=>e.id===t)||{id:0,title:"",description:""}}}},function(e,t,n){var i={"./create.notes.table.ts":10,"./create.users.table.ts":15};function r(e){var t=u(e);return n(t)}function u(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=u,e.exports=r,r.id=9},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,u){function o(e){try{a(i.next(e))}catch(e){u(e)}}function s(e){try{a(i.throw(e))}catch(e){u(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const u=r(n(0));t.default=class{up(){return i(this,void 0,void 0,(function*(){return(yield u.default()).query("\n      create table notes (\n        id bigserial not null constraint notes_pkey primary key,\n        title varchar(255) not null,\n        description text\n      );\n    ")}))}down(){}}},function(e,t,n){var i={"./pgsql.ts":12};function r(e){var t=u(e);return n(t)}function u(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=u,e.exports=r,r.id=11},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,u){function o(e){try{a(i.next(e))}catch(e){u(e)}}function s(e){try{a(i.throw(e))}catch(e){u(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const u=n(13),o=r(n(1)),s=r(n(14)),{DB_HOST:a="localhost",DB_PORT:l=5432,DB_NAME:c="postgres",DB_USER:d="postgres",DB_PASSWORD:f=""}=o.default(process.env);class p{get connection(){return p._client}init(){return i(this,void 0,void 0,(function*(){if(!p._client){yield s.default({host:a,port:l,timeout:15e3});const e=new u.Client({user:d,host:a,database:c,password:f,port:l});yield e.connect(),p._client=e}return this}))}query(e){return i(this,void 0,void 0,(function*(){return this.connection.query(e)}))}}t.default=p},function(e,t){e.exports=require("pg")},function(e,t){e.exports=require("wait-port")},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,u){function o(e){try{a(i.next(e))}catch(e){u(e)}}function s(e){try{a(i.throw(e))}catch(e){u(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const u=r(n(0));t.default=class{up(){return i(this,void 0,void 0,(function*(){return(yield u.default()).query("\n      create table users (\n        id bigserial not null constraint users_pkey primary key,\n        name varchar(255) not null,\n        email varchar(255) not null constraint users_email_unique unique,\n        password varchar(255) not null,\n        auth_token varchar(100),\n        active boolean default true not null\n      );\n    ")}))}down(){}}}]).default;